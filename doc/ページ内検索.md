# ページ内検索

## 構造

区分番号一覧におけるHTMLの構造は以下の通り

```
<body>
  <div id='all'>
    <div id='breadcrumb'>
      <div id='menu'></div>
      <script type='text/javascript' src='../../menu.js'></script>
    </div>
    <div id='content'>
      <h1 class='title'>令和06年医科診療報酬点数表 区分番号一覧</h1>
      <p style='...'><a href='...'>旧</a> <a href='A000.html'>新</a> <a href='...'>比較</a> Ａ０００ 初診料</p>
      ...
    </div>
  </div>
```

# 変更の方針

「div id='breadcrumb'」内にページ内検索用のテキストボックスを追加する。
ここのHTMLテキストはJavaScriptにより動的に生成されるので、
テキストボックスも同様に動的に生成することになる。
「div id='breadcrumb'」を持つページはすべてページ内検索ができる。

変更するファイルは以下のふたつとなる。
* all.css
* menu.js

# 参考としたページ

## ページ内検索

[リアルタイムにページ内検索をしてハイライト表示する](https://mo2nabe.com/js-search-in-page/)

## クリアボタン付きテキストボックス

[How do I put a clear button inside my HTML text input box like the iPhone does?](https://stackoverflow.com/questions/2803532/how-do-i-put-a-clear-button-inside-my-html-text-input-box-like-the-iphone-does)

テキストボックスの右端に
丸付きの「x」ボタンを配置し、
これをクリックするとテキストボックスを
クリアする。

## ハイライトされない不具合(2025-12-12)

### 検索文字列

"-" (半角ハイフン)

### 表示

４つのハイフンが全くハイライトされない。

```
－ － －－ Ａ００３ 削除
```

### ソース

```
<p style='margin-left:5.5em;text-indent:-5.5em'>－ － －－ Ａ００３ 削除</p>
```

rawSearchWord=-
searchWord=[-ー]
contentRegexp=/(?<=>[^<>]*)([-ー－])/gi
rawRegexp=/[-ー－]/gi

## 原因
段落のinnerHTMLを置換しているが、innerHTMLには
タグがないのでcontentRegexpにマッチしない。

## 対策
段落のouterHTMLを置換するようにした。

# 全角半角変換

Unicodeにおける全角と半角の対応表

```
Fullwidth ASCII variants（全角ASCII）
Unicode 	表示 	名称 	備考
FF01 	！ 	Fullwidth Exclamation Mark 	≈<wide>0021(!)
FF02 	＂ 	Fullwidth Quotation Mark 	≈<wide>0022(")
FF03 	＃ 	Fullwidth Number Sign 	≈<wide>0023(#)
FF04 	＄ 	Fullwidth Dollar Sign 	≈<wide>0024($)
FF05 	％ 	Fullwidth Percent Sign 	≈<wide>0025(%)
FF06 	＆ 	Fullwidth Ampersand 	≈<wide>0026(&)
FF07 	＇ 	Fullwidth Apostrophe 	≈<wide>0027(')
FF08 	（ 	Fullwidth Left Parenthesis 	≈<wide>0028(()
FF09 	） 	Fullwidth Right Parenthesis 	≈<wide>0029())
FF0A 	＊ 	Fullwidth Asterisk 	≈<wide>002A(*)
FF0B 	＋ 	Fullwidth Plus Sign 	≈<wide>002B(+)
FF0C 	， 	Fullwidth Comma 	→3001(、) ≈<wide>002C(,)
FF0D 	－ 	Fullwidth Hyphen-Minus 	≈<wide>002D(-)
FF0E 	． 	Fullwidth Full Stop 	≈<wide>002E(.)
FF0F 	／ 	Fullwidth Solidus 	≈<wide>002F(/)
FF10 	０ 	Fullwidth Digit Zero 	≈<wide>0030(0)
FF11 	１ 	Fullwidth Digit One 	≈<wide>0031(1)
FF12 	２ 	Fullwidth Digit Two 	≈<wide>0032(2)
FF13 	３ 	Fullwidth Digit Three 	≈<wide>0033(3)
FF14 	４ 	Fullwidth Digit Four 	≈<wide>0034(4)
FF15 	５ 	Fullwidth Digit Five 	≈<wide>0035(5)
FF16 	６ 	Fullwidth Digit Six 	≈<wide>0036(6)
FF17 	７ 	Fullwidth Digit Seven 	≈<wide>0037(7)
FF18 	８ 	Fullwidth Digit Eight 	≈<wide>0038(8)
FF19 	９ 	Fullwidth Digit Nine 	≈<wide>0039(9)
FF1A 	： 	Fullwidth Colon 	≈<wide>003A(:)
FF1B 	； 	Fullwidth Semicolon 	≈<wide>003B(;)
FF1C 	＜ 	Fullwidth Less-Than Sign 	≈<wide>003C(<)
FF1D 	＝ 	Fullwidth Equals Sign 	≈<wide>003D(=)
FF1E 	＞ 	Fullwidth Greater-Than Sign 	≈<wide>003E(>)
FF1F 	？ 	Fullwidth Question Mark 	≈<wide>003F(?)
FF20 	＠ 	Fullwidth Commercial At 	≈<wide>0040(@)
FF21 	Ａ 	Fullwidth Latin Capital Letter A 	≈<wide>0041(A)
FF22 	Ｂ 	Fullwidth Latin Capital Letter B 	≈<wide>0042(B)
FF23 	Ｃ 	Fullwidth Latin Capital Letter C 	≈<wide>0043(C)
FF24 	Ｄ 	Fullwidth Latin Capital Letter D 	≈<wide>0044(D)
FF25 	Ｅ 	Fullwidth Latin Capital Letter E 	≈<wide>0045(E)
FF26 	Ｆ 	Fullwidth Latin Capital Letter F 	≈<wide>0046(F)
FF27 	Ｇ 	Fullwidth Latin Capital Letter G 	≈<wide>0047(G)
FF28 	Ｈ 	Fullwidth Latin Capital Letter H 	≈<wide>0048(H)
FF29 	Ｉ 	Fullwidth Latin Capital Letter I 	≈<wide>0049(I)
FF2A 	Ｊ 	Fullwidth Latin Capital Letter J 	≈<wide>004A(J)
FF2B 	Ｋ 	Fullwidth Latin Capital Letter K 	≈<wide>004B(K)
FF2C 	Ｌ 	Fullwidth Latin Capital Letter L 	≈<wide>004C(L)
FF2D 	Ｍ 	Fullwidth Latin Capital Letter M 	≈<wide>004D(M)
FF2E 	Ｎ 	Fullwidth Latin Capital Letter N 	≈<wide>004E(N)
FF2F 	Ｏ 	Fullwidth Latin Capital Letter O 	≈<wide>004F(O)
FF30 	Ｐ 	Fullwidth Latin Capital Letter P 	≈<wide>0050(P)
FF31 	Ｑ 	Fullwidth Latin Capital Letter Q 	≈<wide>0051(Q)
FF32 	Ｒ 	Fullwidth Latin Capital Letter R 	≈<wide>0052(R)
FF33 	Ｓ 	Fullwidth Latin Capital Letter S 	≈<wide>0053(S)
FF34 	Ｔ 	Fullwidth Latin Capital Letter T 	≈<wide>0054(T)
FF35 	Ｕ 	Fullwidth Latin Capital Letter U 	≈<wide>0055(U)
FF36 	Ｖ 	Fullwidth Latin Capital Letter V 	≈<wide>0056(V)
FF37 	Ｗ 	Fullwidth Latin Capital Letter W 	≈<wide>0057(W)
FF38 	Ｘ 	Fullwidth Latin Capital Letter X 	≈<wide>0058(X)
FF39 	Ｙ 	Fullwidth Latin Capital Letter Y 	≈<wide>0059(Y)
FF3A 	Ｚ 	Fullwidth Latin Capital Letter Z 	≈<wide>005A(Z)
FF3B 	［ 	Fullwidth Left Square Bracket 	≈<wide>005B([)
FF3C 	＼ 	Fullwidth Reverse Solidus 	≈<wide>005C(\)
FF3D 	］ 	Fullwidth Right Square Bracket 	≈<wide>005D(])
FF3E 	＾ 	Fullwidth Circumflex Accent 	≈<wide>005E(^)
FF3F 	＿ 	Fullwidth Low Line 	≈<wide>005F(_)
FF40 	｀ 	Fullwidth Grave Accent 	≈<wide>0060(`)
FF41 	ａ 	Fullwidth Latin Small Letter A 	≈<wide>0061(a)
FF42 	ｂ 	Fullwidth Latin Small Letter B 	≈<wide>0062(b)
FF43 	ｃ 	Fullwidth Latin Small Letter C 	≈<wide>0063(c)
FF```44 	ｄ 	Fullwidth Latin Small Letter D 	≈<wide>0064(d)
FF45 	ｅ 	Fullwidth Latin Small Letter E 	≈<wide>0065(e)
FF46 	ｆ 	Fullwidth Latin Small Letter F 	≈<wide>0066(f)
FF47 	ｇ 	Fullwidth Latin Small Letter G 	≈<wide>0067(g)
FF48 	ｈ 	Fullwidth Latin Small Letter H 	≈<wide>0068(h)
FF49 	ｉ 	Fullwidth Latin Small Letter I 	≈<wide>0069(i)
FF4A 	ｊ 	Fullwidth Latin Small Letter J 	≈<wide>006A(j)
FF4B 	ｋ 	Fullwidth Latin Small Letter K 	≈<wide>006B(k)
FF4C 	ｌ 	Fullwidth Latin Small Letter L 	≈<wide>006C(l)
FF4D 	ｍ 	Fullwidth Latin Small Letter M 	≈<wide>006D(m)
FF4E 	ｎ 	Fullwidth Latin Small Letter N 	≈<wide>006E(n)
FF4F 	ｏ 	Fullwidth Latin Small Letter O 	≈<wide>006F(o)
FF50 	ｐ 	Fullwidth Latin Small Letter P 	≈<wide>0070(p)
FF51 	ｑ 	Fullwidth Latin Small Letter Q 	≈<wide>0071(q)
FF52 	ｒ 	Fullwidth Latin Small Letter R 	≈<wide>0072(r)
FF53 	ｓ 	Fullwidth Latin Small Letter S 	≈<wide>0073(s)
FF54 	ｔ 	Fullwidth Latin Small Letter T 	≈<wide>0074(t)
FF55 	ｕ 	Fullwidth Latin Small Letter U 	≈<wide>0075(u)
FF56 	ｖ 	Fullwidth Latin Small Letter V 	≈<wide>0076(v)
FF57 	ｗ 	Fullwidth Latin Small Letter W 	≈<wide>0077(w)
FF58 	ｘ 	Fullwidth Latin Small Letter X 	≈<wide>0078(x)
FF59 	ｙ 	Fullwidth Latin Small Letter Y 	≈<wide>0079(y)
FF5A 	ｚ 	Fullwidth Latin Small Letter Z 	≈<wide>007A(z)
FF5B 	｛ 	Fullwidth Left Curly Bracket 	≈<wide>007B({)
FF5C 	｜ 	Fullwidth Vertical Line 	≈<wide>007C(|)
FF5D 	｝ 	Fullwidth Right Curly Bracket 	≈<wide>007D(})
FF5E 	～ 	Fullwidth Tilde 	→301C(〜) ≈<wide>007E(~)
```